@echo off
chcp 65001 >nul
cd /d "%~dp0"

set "PATH=C:\Program Files\Git\bin;C:\Program Files (x86)\Git\bin;%PATH%"

echo.
echo node_modules 제외하고 다시 커밋 후 푸시합니다...
echo.

REM 마지막 커밋 취소 (파일은 그대로 둠)
git reset --soft HEAD~1

REM 스테이징 해제
git reset

REM .gitignore 적용해서 다시 추가 (node_modules 제외됨)
git add .

echo.
echo 스테이징된 파일 확인 (node_modules 없어야 함):
git status

echo.
pause
echo.

git commit -m "Add full SELFit prototype (without node_modules)"
git branch -M main
git push -u origin main

if %ERRORLEVEL% NEQ 0 (
    echo.
    echo 푸시 실패.
) else (
    echo.
    echo 완료.
)
pause
